<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Moon Phase â€“ Today & Next 7 Days</title>
  <style>
    :root {
      --bg: #0b1020;
      --panel: #10162b;
      --card: #121a33;
      --text: #e6e9f5;
      --muted: #9aa3c7;
      --accent: #7aa2ff;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif;
      background: radial-gradient(1200px 800px at 80% -20%, #1b2550 0%, var(--bg) 55%);
      color: var(--text);
    }
    .wrap { max-width: 1000px; margin: 0 auto; padding: 24px; }
    header { display: flex; align-items: center; justify-content: space-between; gap: 16px; }
    h1 { font-weight: 800; letter-spacing: 0.2px; font-size: clamp(20px, 3vw, 28px); margin: 0; }
    .sub { color: var(--muted); font-size: 14px; }

    .panel { background: linear-gradient(180deg, #11193a, var(--panel)); border: 1px solid #1f2a55; border-radius: 16px; padding: 16px; box-shadow: 0 20px 60px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.05); }
    .today { display: grid; grid-template-columns: 160px 1fr; gap: 20px; align-items: center; }
    @media (max-width: 640px){ .today { grid-template-columns: 1fr; text-align: center; } }

    .moonSVG { width: 160px; height: 160px; }
    .meta { display: grid; gap: 8px; }
    .meta .kvs { display: grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: 8px; }
    .kv { background: var(--card); border: 1px solid #1f2a55; border-radius: 12px; padding: 10px 12px; }
    .kv .k { color: var(--muted); font-size: 12px; }
    .kv .v { font-weight: 700; }

    .actions { margin-top: 14px; }
    button { cursor: pointer; background: linear-gradient(180deg, #2a3a8a, #243375); color: #fff; border: 1px solid #3a4cb2; padding: 10px 14px; border-radius: 12px; font-weight: 700; letter-spacing: .2px; box-shadow: 0 8px 20px rgba(31,44,120,.35), inset 0 1px 0 rgba(255,255,255,.08); }
    button:hover { filter: brightness(1.05); }

    .grid7 { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; margin-top: 12px; }
    .card { background: var(--card); border: 1px solid #1f2a55; border-radius: 14px; padding: 12px; display: grid; justify-items: center; gap: 8px; }
    .date { color: var(--muted); font-size: 12px; letter-spacing: .2px; }
    .label { font-weight: 700; text-align: center; }
    .illum { color: var(--muted); font-size: 12px; }

    footer { margin-top: 20px; color: var(--muted); font-size: 12px; text-align: center; }
    a { color: var(--accent); text-decoration: none; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        

  <script>
    const TAU = Math.PI * 2;
    const frac = x => x - Math.floor(x);

    function toJulian(date){
      return date.getTime()/86400000 + 2440587.5;
    }

    function moonPhase(date){
      const jd = toJulian(date);
      const synodic = 29.530588853;
      const k = (jd - 2451550.1) / synodic;
      const p = frac(k);
      const age = p * synodic;
      const illum = 0.5 * (1 - Math.cos(TAU * p));
      return { phase: p, ageDays: age, illum };
    }

    function phaseName(p){
      if (p < 0.03 || p > 0.97) return 'New Moon';
      if (p < 0.22) return 'Waxing Crescent';
      if (p < 0.28) return 'First Quarter';
      if (p < 0.47) return 'Waxing Gibbous';
      if (p < 0.53) return 'Full Moon';
      if (p < 0.72) return 'Waning Gibbous';
      if (p < 0.78) return 'Last Quarter';
      return 'Waning Crescent';
    }

    // ðŸ”„ Inverted moon colors
    function moonSVG(p, size=160){
      const r = size/2;
      const x = 2*p - 1;
      const absx = Math.abs(x);
      const dir = x >= 0 ? 1 : -1;

      const scaleX = 1 - absx;
      const shift = dir * r * 0.65;

      const id = 'm' + Math.random().toString(36).slice(2);
      return `
      <svg viewBox="0 0 ${size} ${size}" width="${size}" height="${size}" class="moonSVG" aria-label="Moon icon">
        <defs>
          <radialGradient id="g-${id}" cx="35%" cy="30%" r="75%">
            <stop offset="0%" stop-color="#111111"/>
            <stop offset="60%" stop-color="#222222"/>
            <stop offset="100%" stop-color="#000000"/>
          </radialGradient>
          <filter id="shadow-${id}" x="-50%" y="-50%" width="200%" height="200%">
            <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#fff" flood-opacity="0.6"/>
          </filter>
          <clipPath id="clip-${id}">
            <circle cx="${r}" cy="${r}" r="${r}" />
          </clipPath>
          <mask id="mask-${id}">
            <rect width="100%" height="100%" fill="black"/>
            <g transform="translate(${r+shift}, ${r}) scale(${scaleX}, 1)">
              <circle cx="0" cy="0" r="${r}" fill="white" />
            </g>
          </mask>
        </defs>
        <!-- Base circle is now white -->
        <circle cx="${r}" cy="${r}" r="${r}" fill="#ffffff" stroke="#cccccc" stroke-width="2" filter="url(#shadow-${id})"/>
        <!-- Lit portion is now dark -->
        <g clip-path="url(#clip-${id})" mask="url(#mask-${id})">
          <circle cx="${r}" cy="${r}" r="${r}" fill="url(#g-${id})"/>
        </g>
        <circle cx="${r}" cy="${r}" r="${r-1.5}" fill="none" stroke="rgba(0,0,0,.15)" stroke-width="3"/>
      </svg>`;
    }

    function fmtDate(d){
      return d.toLocaleDateString(undefined, { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' });
    }

    function fmtShort(d){
      return d.toLocaleDateString(undefined, { weekday: 'short', month: 'short', day: 'numeric' });
    }

    function percent(n){ return (n*100).toFixed(1) + '%'; }

    function renderToday(){
      const now = new Date();
      const { phase, ageDays, illum } = moonPhase(now);

      document.getElementById('now').textContent = now.toLocaleString();
      document.getElementById('todayMoon').innerHTML = moonSVG(phase, 160);
      document.getElementById('todayLabel').textContent = phaseName(phase);
      document.getElementById('todayDate').textContent = fmtDate(now);
      document.getElementById('todayIllum').textContent = percent(illum);
      document.getElementById('todayAge').textContent = ageDays.toFixed(1) + ' days';
    }

    function render7(){
      const grid = document.getElementById('grid7');
      grid.innerHTML = '';
      const base = new Date();
      for(let i=1;i<=7;i++){
        const d = new Date(base.getFullYear(), base.getMonth(), base.getDate()+i);
        const { phase, illum } = moonPhase(d);
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          ${moonSVG(phase, 120)}
          <div class="label">${phaseName(phase)}</div>
          <div class="date">${fmtShort(d)}</div>
          <div class="illum">${percent(illum)} lit</div>
        `;
        grid.appendChild(card);
      }
    }

    const toggleBtn = document.getElementById('toggle7');
    const sevenPanel = document.getElementById('sevenPanel');
    toggleBtn.addEventListener('click', () => {
      const show = sevenPanel.style.display === 'none';
      sevenPanel.style.display = show ? 'block' : 'none';
      toggleBtn.textContent = show ? 'â–¼ Hide Next 7 Days' : 'â–¶ Next 7 Days';
      if (show) render7();
    });

    renderToday();
    setInterval(() => {
      renderToday();
      if (sevenPanel.style.display !== 'none') render7();
    }, 60 * 1000);
  </script>
</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Moon Phase â€“ Today & Next 7 Days</title>
  <style>
    :root {
      --bg: #0b1020;
      --panel: #10162b;
      --card: #121a33;
      --text: #e6e9f5;
      --muted: #9aa3c7;
      --accent: #7aa2ff;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif;
      background: radial-gradient(1200px 800px at 80% -20%, #1b2550 0%, var(--bg) 55%);
      color: var(--text);
    }
    .wrap { max-width: 1000px; margin: 0 auto; padding: 24px; }
    header { display: flex; align-items: center; justify-content: space-between; gap: 16px; }
    h1 { font-weight: 800; letter-spacing: 0.2px; font-size: clamp(20px, 3vw, 28px); margin: 0; }
    .sub { color: var(--muted); font-size: 14px; }

    .panel { background: linear-gradient(180deg, #11193a, var(--panel)); border: 1px solid #1f2a55; border-radius: 16px; padding: 16px; box-shadow: 0 20px 60px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.05); }
    .today { display: grid; grid-template-columns: 160px 1fr; gap: 20px; align-items: center; }
    @media (max-width: 640px){ .today { grid-template-columns: 1fr; text-align: center; } }

    .moonSVG { width: 160px; height: 160px; }
    .meta { display: grid; gap: 8px; }
    .meta .kvs { display: grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: 8px; }
    .kv { background: var(--card); border: 1px solid #1f2a55; border-radius: 12px; padding: 10px 12px; }
    .kv .k { color: var(--muted); font-size: 12px; }
    .kv .v { font-weight: 700; }

    .actions { margin-top: 14px; }
    button { cursor: pointer; background: linear-gradient(180deg, #2a3a8a, #243375); color: #fff; border: 1px solid #3a4cb2; padding: 10px 14px; border-radius: 12px; font-weight: 700; letter-spacing: .2px; box-shadow: 0 8px 20px rgba(31,44,120,.35), inset 0 1px 0 rgba(255,255,255,.08); }
    button:hover { filter: brightness(1.05); }

    .grid7 { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; margin-top: 12px; }
    .card { background: var(--card); border: 1px solid #1f2a55; border-radius: 14px; padding: 12px; display: grid; justify-items: center; gap: 8px; }
    .date { color: var(--muted); font-size: 12px; letter-spacing: .2px; }
    .label { font-weight: 700; text-align: center; }
    .illum { color: var(--muted); font-size: 12px; }

    footer { margin-top: 20px; color: var(--muted); font-size: 12px; text-align: center; }
    a { color: var(--accent); text-decoration: none; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>ðŸŒ• Moon Phase â€“ Today & Next 7 Days</h1>
        <div class="sub">Auto-updates daily; times use your local timezone.</div>
      </div>
      <div id="now" class="sub"></div>
    </header>

    <section class="panel today">
      <div id="todayMoon"></div>
      <div class="meta">
        <div>
          <div id="todayLabel" class="label" style="font-size: 18px;"></div>
          <div id="todayDate" class="date"></div>
        </div>
        <div class="kvs">
          <div class="kv">
            <div class="k">Illumination</div>
            <div id="todayIllum" class="v"></div>
          </div>
          <div class="kv">
            <div class="k">Age in cycle</div>
            <div id="todayAge" class="v"></div>
          </div>
        </div>
        <div class="actions">
          <button id="toggle7">â–¶ Next 7 Days</button>
        </div>
      </div>
    </section>

    <section id="sevenPanel" class="panel" style="display:none;">
      <div class="grid7" id="grid7"></div>
    </section>

    <footer>
      Built with a lightweight astronomical approximation (synodic month 29.5306 d). Images are generated locally (no APIs).
    </footer>
  </div>

  <script>
    const TAU = Math.PI * 2;
    const frac = x => x - Math.floor(x);

    function toJulian(date){
      return date.getTime()/86400000 + 2440587.5;
    }

    function moonPhase(date){
      const jd = toJulian(date);
      const synodic = 29.530588853;
      const k = (jd - 2451550.1) / synodic;
      const p = frac(k);
      const age = p * synodic;
      const illum = 0.5 * (1 - Math.cos(TAU * p));
      return { phase: p, ageDays: age, illum };
    }

    function phaseName(p){
      if (p < 0.03 || p > 0.97) return 'New Moon';
      if (p < 0.22) return 'Waxing Crescent';
      if (p < 0.28) return 'First Quarter';
      if (p < 0.47) return 'Waxing Gibbous';
      if (p < 0.53) return 'Full Moon';
      if (p < 0.72) return 'Waning Gibbous';
      if (p < 0.78) return 'Last Quarter';
      return 'Waning Crescent';
    }

    // ðŸ”„ Inverted moon colors
    function moonSVG(p, size=160){
      const r = size/2;
      const x = 2*p - 1;
      const absx = Math.abs(x);
      const dir = x >= 0 ? 1 : -1;

      const scaleX = 1 - absx;
      const shift = dir * r * 0.65;

      const id = 'm' + Math.random().toString(36).slice(2);
      return `
      <svg viewBox="0 0 ${size} ${size}" width="${size}" height="${size}" class="moonSVG" aria-label="Moon icon">
        <defs>
          <radialGradient id="g-${id}" cx="35%" cy="30%" r="75%">
            <stop offset="0%" stop-color="#111111"/>
            <stop offset="60%" stop-color="#222222"/>
            <stop offset="100%" stop-color="#000000"/>
          </radialGradient>
          <filter id="shadow-${id}" x="-50%" y="-50%" width="200%" height="200%">
            <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#fff" flood-opacity="0.6"/>
          </filter>
          <clipPath id="clip-${id}">
            <circle cx="${r}" cy="${r}" r="${r}" />
          </clipPath>
          <mask id="mask-${id}">
            <rect width="100%" height="100%" fill="black"/>
            <g transform="translate(${r+shift}, ${r}) scale(${scaleX}, 1)">
              <circle cx="0" cy="0" r="${r}" fill="white" />
            </g>
          </mask>
        </defs>
        <!-- Base circle is now white -->
        <circle cx="${r}" cy="${r}" r="${r}" fill="#ffffff" stroke="#cccccc" stroke-width="2" filter="url(#shadow-${id})"/>
        <!-- Lit portion is now dark -->
        <g clip-path="url(#clip-${id})" mask="url(#mask-${id})">
          <circle cx="${r}" cy="${r}" r="${r}" fill="url(#g-${id})"/>
        </g>
        <circle cx="${r}" cy="${r}" r="${r-1.5}" fill="none" stroke="rgba(0,0,0,.15)" stroke-width="3"/>
      </svg>`;
    }

    function fmtDate(d){
      return d.toLocaleDateString(undefined, { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' });
    }

    function fmtShort(d){
      return d.toLocaleDateString(undefined, { weekday: 'short', month: 'short', day: 'numeric' });
    }

    function percent(n){ return (n*100).toFixed(1) + '%'; }

    function renderToday(){
      const now = new Date();
      const { phase, ageDays, illum } = moonPhase(now);

      document.getElementById('now').textContent = now.toLocaleString();
      document.getElementById('todayMoon').innerHTML = moonSVG(phase, 160);
      document.getElementById('todayLabel').textContent = phaseName(phase);
      document.getElementById('todayDate').textContent = fmtDate(now);
      document.getElementById('todayIllum').textContent = percent(illum);
      document.getElementById('todayAge').textContent = ageDays.toFixed(1) + ' days';
    }

    function render7(){
      const grid = document.getElementById('grid7');
      grid.innerHTML = '';
      const base = new Date();
      for(let i=1;i<=7;i++){
        const d = new Date(base.getFullYear(), base.getMonth(), base.getDate()+i);
        const { phase, illum } = moonPhase(d);
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          ${moonSVG(phase, 120)}
          <div class="label">${phaseName(phase)}</div>
          <div class="date">${fmtShort(d)}</div>
          <div class="illum">${percent(illum)} lit</div>
        `;
        grid.appendChild(card);
      }
    }

    const toggleBtn = document.getElementById('toggle7');
    const sevenPanel = document.getElementById('sevenPanel');
    toggleBtn.addEventListener('click', () => {
      const show = sevenPanel.style.display === 'none';
      sevenPanel.style.display = show ? 'block' : 'none';
      toggleBtn.textContent = show ? 'â–¼ Hide Next 7 Days' : 'â–¶ Next 7 Days';
      if (show) render7();
    });

    renderToday();
    setInterval(() => {
      renderToday();
      if (sevenPanel.style.display !== 'none') render7();
    }, 60 * 1000);
  </script>
</body>
</html>
